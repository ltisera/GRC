<html>
    <head>
        <script src="/js/jquery-3.3.1.js"></script>
        <script>
            $(function(){
                $("#includedContent").load("/header1");
            });
            $(document).ready(function(){

                misCookies = document.cookie
                listaCookies = misCookies.split(";")
                console.log("ACA TA LERROR1")
                for (i in listaCookies) {
                    busca = listaCookies[i].search("idUsuarioLogueado");
                    if (busca > -1) {
                        micookie=listaCookies[i]
                        igual = micookie.indexOf("=");
                        valor = micookie.substring(igual+1);
                    }
                }
                
                $("body").on("click",".btnGrupos",function(){
                    document.cookie = "idGrupoLogueado=" + this.id.substring(this.id.indexOf("=")+1);
                    window.location.href = ('http://localhost:5000/inicio')
                });


                $.ajax({
                    data : {
                        "usuario" : valor,
                    },
                    url : "cargarListaGrupo",
                    type : "POST",
                    beforeSend : function() {
                        console.log("ACA TA LERROR2")
                        $('#gruposLista').html("Cargando Grupos");
                    },
                    success : function(response) {
                        $('#gruposLista').html(response);
                        console.log(response);
                        $("#columnaIzquierda").append('<br><img id = "IMGagregar" div="grupoFoto" class="img-circle GrupIMG" src="https://image.flaticon.com/icons/svg/25/25340.svg" alt="Generic placeholder image" width="50" height="50"><br>'+ "AGREGAR");
                        if(response[0]==null){
                            console.log("SOY NULL");
                        }
                        else{
                            for(i=0; i < response.length; i++){
                            var nombre = response[0][i][1]
                            if(nombre.length > 7){
                                nombre = response[0][i][1].slice(0, 5) + "..."
                            }
                            
                            $("#columnaIzquierda").append('<br><img id = "IMG'+String(i)+'" div="grupoFoto" class="img-circle GrupIMG" src="https://images.emojiterra.com/google/android-oreo/512px/1f625.png" alt="Generic placeholder image" width="50" height="50"><br>'+ nombre);
                            $("#IMG"+i).data('elNombre', String(response[0][i][1]));
                            $("#IMG"+i).tooltip({title: String(response[0][i][2]), trigger: "hover", placement: "right"});
                            }
                        }
                        
                    },
                    error : function(response) {
                        $('#divUsuarioSinGrupo').show()
                        $.ajax({
                            url: "traerTodosGrupos",
                            success: function(response){
                                $('#lblCantGrupos').text(response.length);
                                console.log(response);
                                var opcion = document.createElement("option");
                                $('#lstGrupos').empty();
                                opcion.text = "Seleccione un grupo"
                                opcion.value = "vacio"
                                $('#lstGrupos').append(opcion);
                                for (i = 0; i < response.length;i++){
                                    var opcion = document.createElement("option");
                                    opcion.text = response[i][1];
                                    opcion.value = i
                                    $('#lstGrupos').append(opcion);
                                    console.log("Agregando: ", response[i][1])
                                }
                            },
                            error: function(response){alert("error")}
                        });

                    }
                });
        
            });
              
            $(document).on('click', ".GrupIMG", function() {
                console.log($(this).attr('id') + ": " + $(this).data('elNombre'));
                if($(this).attr('id') == "IMGagregar"){
                    console.log("CLICKITO");
                    if($('#divAgregarGrupo').is(':visible')){
                        $('#divAgregarGrupo').hide();
                    }
                    else{
                        $('#divAgregarGrupo').show();
                    }
                }
            });
            
        </script>
        <link rel="stylesheet" href="static/css/estilos.css" />
    </head>

    <style type="text/css">

    </style>
    
    <div id="includedContent"></div>

    <body>
            <div id="columnaIzquierda">
                Grupos:           
            </div>
            <div id="columnaDerecha">
                <div id="divAgregarGrupo" class="referencia">
                    <div class="clsTitulo"> Creacion de Grupos</div>
                    <div class="container">
                        Nombre Del Grupo:<br>
                        <input type="text" name=""><br>
                        Descripcion Del Grupo:<br>
                        <input type="text" name=""><br>
                        Fotico:<br>
                        <input type="text" name=""><br>
                        <button id="save" class="btn btn-primary">Crear Grupo</button>
                    </div>
                </div>
                <br>
                <div id="divAdminGrupo" class="referencia">
                    <div class="clsTitulo"> Panel de control... MATAR USUARIOS</div>
                    <div class="container">
                        Invitar USUSARIO:<br>
                        <input type="text" name=""><br>
                        Expulsar Usuario:<br>
                        <input type="text" name=""><br>
                        Chupala usuario:<br>
                        <input type="text" name=""><br>
                        <button id="save" class="btn btn-primary">EXPULSAR</button>
                    </div>
                </div>
                <br>
                <div class="referencia">
                    Lorem ipsum dolor sit amet consectetur adipiscing elit proin, consequat quam placerat conubia volutpat aptent fames habitasse, risus mus enim dis ut posuere massa. Potenti etiam habitasse risus arcu sem facilisis penatibus diam, bibendum taciti dis vestibulum habitant cubilia lobortis in aenean, convallis tincidunt nibh mauris fringilla ultrices lacus. Molestie fusce aliquam suscipit id aptent taciti ante risus, pellentesque sociis conubia inceptos aliquet curabitur sapien, semper nostra tempus ligula ad habitant consequat.
                    <br>
                    Sollicitudin hendrerit tincidunt torquent tempus vestibulum tellus volutpat luctus, suscipit taciti ac quisque ultrices dignissim cras. Suscipit dui ultricies id est mus tempor taciti ante laoreet natoque nisi, torquent rhoncus curae mattis lectus pulvinar ad libero nisl pellentesque. Ut netus suspendisse posuere viverra iaculis augue, pellentesque cursus vestibulum euismod vel, erat eu ultrices in fermentum.
                </div>
                

            </div>
    </body>
            
</html>
